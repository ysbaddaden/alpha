<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr">
<head>
</head>
<body>

  <div class="block" id="main">
    <div>
      <section></section>
      
      <p>
        <a href=""></a>
      </p>
      <p class="block">
        <a href="" id="link" class="edit"></a>
        <a href="" class="edit test" lang="tr"></a>
      </p>
      
      <section></section>
      <section class="toc"></section>
      <section></section>
    </div>
    
    <article class="dtd-example">
      <p class="empty"></p>
    </article>
  </div>
  
  <p class="c">
    <a href="" class="more" id="bug"></a>
  </p>


<script type="text/javascript" src="jsunit.js"></script>
<script type="text/javascript" src="loader.js"></script>
<script type="text/javascript">
load_compat('..');
</script>

<!--script type="text/javascript" src="http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js"></script-->
<script type="text/javascript">

// IE will have a lot of failures, since it doesn't understand any HTML5 elements,
// and looks like it refuses to consider them as elements.

jsUnit.add('document.querySelectorAll', function() {
  jsUnit.assertEquals(typeof document.querySelectorAll, 'function');
});

jsUnit.add('Element.prototype.querySelectorAll', function()
{
  var elm = document.createElement('div');
  jsUnit.assertEquals(typeof elm.querySelectorAll, 'function');
});

// id
jsUnit.add('#main', function() {
  jsUnit.assertEquals(document.querySelectorAll('#main').length, 1);
});
jsUnit.add('#link', function() {
  jsUnit.assertEquals(document.querySelectorAll('#link').length, 1);
});

// tag name
jsUnit.add('div', function() {
  jsUnit.assertEquals(document.querySelectorAll('div').length, 2);
});
jsUnit.add('p', function() {
  jsUnit.assertEquals(document.querySelectorAll('p').length, 4);
});

// classname
jsUnit.add('.block', function() {
  jsUnit.assertEquals(document.querySelectorAll('.block').length, 2);
});
jsUnit.add('.edit', function() {
  jsUnit.assertEquals(document.querySelectorAll('.edit').length, 2);
});

// mixes
jsUnit.add('a.edit', function() {
  jsUnit.assertEquals(document.querySelectorAll('a.edit').length, 2);
});
jsUnit.add('a.nothing', function() {
  jsUnit.assertEquals(document.querySelectorAll('a.nothing').length, 0);
});

jsUnit.add('a#link', function() {
  jsUnit.assertEquals(document.querySelectorAll('a#link').length, 1);
});
jsUnit.add('a#link.edit', function() {
  jsUnit.assertEquals(document.querySelectorAll('a#link.edit').length, 1);
});

// descendant child
jsUnit.add('div p', function() {
  jsUnit.assertEquals(document.querySelectorAll('div p').length, 3);
});
jsUnit.add('p div', function() {
  jsUnit.assertEquals(document.querySelectorAll('p div').length, 0);
});
jsUnit.add('div p a', function() {
  jsUnit.assertEquals(document.querySelectorAll('div p a').length, 3);
});

jsUnit.add('div .edit', function() {
  jsUnit.assertEquals(document.querySelectorAll('div .edit').length, 2);
});
jsUnit.add('div a.edit', function() {
  jsUnit.assertEquals(document.querySelectorAll('div a.edit').length, 2);
});
jsUnit.add('div a#link', function() {
  jsUnit.assertEquals(document.querySelectorAll('div a#link').length, 1);
});
jsUnit.add('div a#nothing .more', function() {
  jsUnit.assertEquals(document.querySelectorAll('div a#nothing .more').length, 0);
});
jsUnit.add('div #bug', function() {
  jsUnit.assertEquals(document.querySelectorAll('div a#bug').length, 0);
});


// operators

jsUnit.add('div > p', function() {
  jsUnit.assertEquals(document.querySelectorAll('div > p').length, 2);
});
jsUnit.add('article > p', function() {
  jsUnit.assertEquals(document.querySelectorAll('article > p').length, 1);
});

jsUnit.add('p + p', function() {
  jsUnit.assertEquals(document.querySelectorAll('p + p').length, 1);
});
jsUnit.add('div + p', function() {
  jsUnit.assertEquals(document.querySelectorAll('div + p').length, 1);
});
jsUnit.add('section+section', function() {
  jsUnit.assertEquals(document.querySelectorAll('section+section').length, 2);
});
jsUnit.add('section + section.toc', function() {
  jsUnit.assertEquals(document.querySelectorAll('section + section.toc').length, 1);
});

jsUnit.add('section ~ section', function() {
  jsUnit.assertEquals(document.querySelectorAll('section ~ section').length, 3);
});

jsUnit.add('div, p, a', function() {
  jsUnit.assertEquals(document.querySelectorAll('div, p, a').length, 10);
});

jsUnit.add('a[class]', function() {
  jsUnit.assertEquals(document.querySelectorAll('a[class]').length, 3);
});
jsUnit.add('a[href]', function() {
  jsUnit.assertEquals(document.querySelectorAll('a[href]').length, 4);
});

jsUnit.add('a[class][href]', function() {
  jsUnit.assertEquals(document.querySelectorAll('a[class][href]').length, 3);
});
jsUnit.add('a[href][lang][class]', function() {
  jsUnit.assertEquals(document.querySelectorAll('a[href][lang][class]').length, 1);
});
jsUnit.add('a[lang][class]', function() {
  jsUnit.assertEquals(document.querySelectorAll('a[lang][class]').length, 1);
});

jsUnit.add('a[class=edit]', function() {
  jsUnit.assertEquals(document.querySelectorAll('a[class=edit]').length, 1);
});
jsUnit.add('a[class~=test]', function() {
  jsUnit.assertEquals(document.querySelectorAll('a[class~=test]').length, 1);
});
jsUnit.add('article[class|=dtd]', function() {
  jsUnit.assertEquals(document.querySelectorAll('article[class|=dtd]').length, 1);
});

jsUnit.add('article[class^=dtd]', function() {
  jsUnit.assertEquals(document.querySelectorAll('article[class^=dtd]').length, 1);
});
jsUnit.add('article[class$=ample]', function() {
  jsUnit.assertEquals(document.querySelectorAll('article[class$=ample]').length, 1);
});
jsUnit.add('article[class*=exam]', function() {
  jsUnit.assertEquals(document.querySelectorAll('article[class*=exam]').length, 1);
});

jsUnit.add('a:first-child', function() {
  jsUnit.assertEquals(document.querySelectorAll('a:first-child').length, 3);
});
jsUnit.add('p:last-child', function() {
  jsUnit.assertEquals(document.querySelectorAll('p:last-child').length, 1);
});
jsUnit.add('p:only-child', function() {
  jsUnit.assertEquals(document.querySelectorAll('p:only-child').length, 1);
});

jsUnit.add('div.block :first-child', function() {
  jsUnit.assertEquals(document.querySelectorAll('div.block :first-child').length, 5);
});
jsUnit.add('div.block :last-child', function() {
  jsUnit.assertEquals(document.querySelectorAll('div.block :last-child').length, 5);
});
jsUnit.add('div.block :only-child', function() {
  jsUnit.assertEquals(document.querySelectorAll('div.block :only-child').length, 2);
});

jsUnit.run();

</script>

</body>
</html>
